<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./assets/styles/style.css">
    <title>Тест-драйв</title>
</head>
<body>
    <div class="big_conz">
        <div class="block_auth">
            <h2 style="color: black; padding: 0;">Тест-драйв</h2>
            <button class="close-button" onclick="location.href='main.html'">&#10006;</button> 
            <input type="text" placeholder="Имя" class="enter" id="nameInput">
            <input type="tel" placeholder="Телефон" class="enter" id="phoneInput" maxlength="11" oninput="formatPhoneNumber(this)">
            <input type="date" placeholder="Дата" class="enter" id="dateInput" oninput="checkDate(this)">
            
                <button class="orange" onclick="saveToCSV()">
                    Записать в файл
                </button>
                <button class="orange" onclick="downloadCSV()">
                    Записаться
                </button>
    
            <div class="support-info">
                <h3 style="font-size: 16px;">Контактная информация:</h3>
                <p style="font-size: 14px;">Телефон: +7 (123) 456-78-90</p>
                <p style="font-size: 14px;">Email: support@example.com</p>
                
                <button class="close-button" onclick="location.href='lifeAkk.html'">&#10006;</button>
            </div>
        </div>
    </div>

    <script>
        function formatPhoneNumber(input) {
            let value = input.value.replace(/\D/g, ''); // Убираем все нецифровые символы
            input.value = value; // Устанавливаем очищенное значение в поле ввода
        }

        function checkDate(input) {
            const today = new Date();
            const selectedDate = new Date(input.value);

            if (selectedDate < today) {
                alert("Дата должна быть больше или равна сегодняшней дате");
                input.value = today.toISOString().slice(0, 10);
            }
        }
             let csvData = []; // Массив для хранения данных

        function saveToCSV() {
            const name = nameInput.value;
            const phone = phoneInput.value;
            const date = dateInput.value;
            const phoneRegex = /^(\+7|8)\d{10}$/;
            if (!phoneRegex.test(phone)) {
                alert("Номер телефона должен быть в формате 89290390339 или +79290390339.");
                return; 
            }
            if (!name || !phone || !date) {
                alert("Все поля должны быть заполнены");
            } else {
            csvData.push([name, phone, date]);

            alert("Записано");
            }
        }

        function downloadCSV() {
            const csvContent = csvData.map(row => row.join(",")).join("\n");
            const blob = new Blob([csvContent], { type: "text/csv" });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = "testDrive.csv";
            link.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
